version: v1.0
name: Initial Pipeline
agent:
  machine:
    type: f1-standard-2
    os_image: ubuntu2204
blocks:
  - name: 'Block #1'
    task:
      jobs:
        - name: 'Job #1'
          commands:
            - checkout
            - kubectl create ns jesus-christ || true
            - 'helm repo add prometheus-community https://prometheus-community.github.io/helm-charts'
            - helm repo update
            - cd 1-monitor-kubernetes
            - ls -la
            - helm install monitoring prometheus-community/kube-prometheus-stack --values monitoring-config.yml
      secrets:
        - name: kubeconfig
